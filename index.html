<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Falling Matrix with Love</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        background-color: black;
        color: green;
        font-family: monospace;
        font-size: 12px;
        white-space: pre;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        width: 100vw;
      }
      #matrix {
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        position: absolute;
        top: 0;
        left: 0;
      }
      #love-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .love-text {
        font-size: 150px;
        font-weight: bold;
        opacity: 0; /* 初始透明度為 0 */
        transition: opacity 3s ease-in-out, color 0.8s ease-in-out;
        color: rgba(255, 105, 180, 0.7); /* 初始顏色為半透明白色 */
      }
      .star {
        font-size: 30px;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      }
    </style>
  </head>
  <body>
    <div id="matrix"></div>
    <div id="love-container">
      <span class="star">✨</span>
      <span class="love-text" id="love-message">Love You~~</span>
      <span class="star">✨</span>
    </div>

    <script>
      const width = Math.floor(window.innerWidth / 12);
      const flipsPerLine = 5;
      const sleepTime = 100;
      const ch = "1234567890qwertyuiopasdfghjklzxcvbnm,./';[]!@#$%^&*()-=_+";
      let switches = Array(width).fill(0);
      const matrixDiv = document.getElementById("matrix");
      const loveMessage = document.getElementById("love-message");
      const stars = document.querySelectorAll(".star");

      function generateMatrixLine() {
        let line = "";
        for (let i = 0; i < width; i++) {
          if (switches[i]) {
            line += ch[Math.floor(Math.random() * ch.length)] + " ";
          } else {
            line += "  ";
          }
        }
        for (let i = 0; i < flipsPerLine; i++) {
          let x = Math.floor(Math.random() * width);
          switches[x] = !switches[x];
        }
        return line;
      }

      function updateMatrix() {
        const newLine = document.createElement("div");
        newLine.textContent = generateMatrixLine();
        matrixDiv.appendChild(newLine);
        if (matrixDiv.children.length > Math.floor(window.innerHeight / 18)) {
          matrixDiv.removeChild(matrixDiv.firstChild);
        }
        setTimeout(updateMatrix, sleepTime);
      }

      updateMatrix();

      // 5 秒後顯示 LOVE YOU 並讓顏色變換、星星閃爍
      setTimeout(() => {
        loveMessage.style.opacity = "0.9"; // 設置透明度為 0.7，帶點曖昧感
        stars.forEach((star) => (star.style.opacity = "1"));

        // 定義充滿愛的顏色（粉紅、紅色、紫色、橙色等）
        const colors = [
          "rgba(255, 105, 180, 0.7)", // 粉紅色
          "rgba(255, 0, 0, 0.7)", // 紅色
          "rgba(128, 0, 128, 0.7)", // 紫色
          "rgba(255, 69, 0, 0.7)", // 橙色
          "rgba(255, 20, 147, 0.7)", // 深粉紅色
        ];
        let colorIndex = 0;

        // 每 0.8 秒變換 LOVE YOU 的顏色
        setInterval(() => {
          loveMessage.style.color = colors[colorIndex];
          colorIndex = (colorIndex + 1) % colors.length;
        }, 800);

        // 星星閃爍效果
        setInterval(() => {
          stars.forEach((star) => {
            star.style.opacity = star.style.opacity === "1" ? "0.3" : "1";
          });
        }, 500);
      }, 5000);
    </script>
  </body>
</html>
